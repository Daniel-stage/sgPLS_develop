<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>PLS performance • sgPLSdevelop</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PLS performance">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sgPLSdevelop</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-performance" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Performance</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-performance">
<li><a class="dropdown-item" href="../articles/PLS_perf.html">PLS performance</a></li>
    <li><a class="dropdown-item" href="../articles/PLSDA_perf.html">PLSDA performance</a></li>
    <li><a class="dropdown-item" href="../articles/sPLS_perf.html">Sparse PLS performance</a></li>
    <li><a class="dropdown-item" href="../articles/gPLS_perf.html">Group PLS performance</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-theory-for-sgpls-methods" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Theory for sgPLS methods</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-theory-for-sgpls-methods">
<li><a class="dropdown-item" href="../articles/PLS_method.html">PLS method</a></li>
    <li><a class="dropdown-item" href="../articles/PLSDA_method.html">PLSDA method</a></li>
    <li><a class="dropdown-item" href="../articles/sPLS_method.html">sPLS method</a></li>
    <li><a class="dropdown-item" href="../articles/gPLS_method.html">gPLS method</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>PLS performance</h1>
            
            <h4 data-toc-skip class="date">2025-07-30</h4>
      

      <div class="d-none name"><code>PLS_perf.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This page presents an application of the PLS performance assessment.
The PLS method is a quite particular method : there are several
predictions according to the number of components selected in the model.
The goal is almost to choose the best number of component in PLS
regression in order to compute the best possible predictions. For that,
we will use three datasets:</p>
<ul>
<li><p>one is a dataset with only one response variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.</p></li>
<li><p>the other is a dataset with four response variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mn>1</mn><mo>,</mo><mi>Y</mi><mn>2</mn><mo>,</mo><mi>Y</mi><mn>3</mn><mo>,</mo><mi>Y</mi><mn>4</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y = (Y1,Y2,Y3,Y4)</annotation></semantics></math>.</p></li>
<li><p>the last dataset contains real data about NIR spectra.</p></li>
</ul>
<p>The goal is also to compare the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">Q2</annotation></semantics></math>
values with the ones of an other package : <code>mixOmics</code>.</p>
<p>To access to predefined functions from sgPLSdevelop package and
manipulate these datasets, run these lines :</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://daniel-stage.github.io/sgPLS_develop/" class="external-link">sgPLSdevelop</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/khliland/pls" class="external-link">pls</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.mixOmics.org" class="external-link">mixOmics</a></span><span class="op">)</span> </span>
<span></span>
<span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data.create.html">data.create</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> </span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data.create.html">data.create</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">10</span>, q <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">yarn</span><span class="op">)</span></span>
<span><span class="va">data3</span> <span class="op">&lt;-</span> <span class="va">yarn</span></span></code></pre></div>
<p>For the two first datasets, the population is set to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>40</mn></mrow><annotation encoding="application/x-tex">n = 40</annotation></semantics></math>
by default, which is close to actual conditions. Let’s also notice that,
on average, the response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
is a linear combination from the predictors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>.
Indeed, the function includes a matrix product
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>X</mi><mi>B</mi><mo>+</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">Y = XB + E</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
the weight matrix and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>E</mi><annotation encoding="application/x-tex">E</annotation></semantics></math>
matrix the gaussian noise. This linearity condition is important in
order to have a good performance of the model, the PLS method using
linearity combinaison.</p>
<p>Now, it’s time to train a PLS model for each dataset built or
imported.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ncomp.max</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span></span>
<span><span class="co"># First model</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data1</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data1</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu">sgPLSdevelop</span><span class="fu">::</span><span class="fu"><a href="../reference/PLS.html">PLS</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,mode <span class="op">=</span> <span class="st">"regression"</span>, ncomp <span class="op">=</span> <span class="va">ncomp.max</span><span class="op">)</span></span>
<span><span class="va">model.mix1</span> <span class="op">&lt;-</span> <span class="fu">mixOmics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mixOmics/man/pls.html" class="external-link">pls</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,mode <span class="op">=</span> <span class="st">"regression"</span>, ncomp <span class="op">=</span> <span class="va">ncomp.max</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Second model</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data2</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data2</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu">sgPLSdevelop</span><span class="fu">::</span><span class="fu"><a href="../reference/PLS.html">PLS</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,mode <span class="op">=</span> <span class="st">"regression"</span>, ncomp <span class="op">=</span> <span class="va">ncomp.max</span><span class="op">)</span></span>
<span><span class="va">model.mix2</span> <span class="op">&lt;-</span> <span class="fu">mixOmics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mixOmics/man/pls.html" class="external-link">pls</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,mode <span class="op">=</span> <span class="st">"regression"</span>, ncomp <span class="op">=</span> <span class="va">ncomp.max</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Third model</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data3</span><span class="op">$</span><span class="va">NIR</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data3</span><span class="op">$</span><span class="va">density</span></span>
<span><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu">sgPLSdevelop</span><span class="fu">::</span><span class="fu"><a href="../reference/PLS.html">PLS</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,mode <span class="op">=</span> <span class="st">"regression"</span>, ncomp <span class="op">=</span> <span class="va">ncomp.max</span><span class="op">)</span></span>
<span><span class="va">model.mix3</span> <span class="op">&lt;-</span> <span class="fu">mixOmics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mixOmics/man/pls.html" class="external-link">pls</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,mode <span class="op">=</span> <span class="st">"regression"</span>, ncomp <span class="op">=</span> <span class="va">ncomp.max</span><span class="op">)</span> </span></code></pre></div>
<p>In the continuation of this article, for each model built, we will
show PLS performance assessment by using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
criterion and then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Q_2</annotation></semantics></math>
criterion. Will also be displayed some plot of the individual projected
on the best components. The following results may differ when executing
the code lines each new time (for the datasets 1 and 2).</p>
</div>
<div class="section level2">
<h2 id="q2-and-msep-criteria">Q2 and MSEP criteria<a class="anchor" aria-label="anchor" href="#q2-and-msep-criteria"></a>
</h2>
<div class="section level4">
<h4 id="msep-criterion">MSEP criterion<a class="anchor" aria-label="anchor" href="#msep-criterion"></a>
</h4>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
is computed as follow :</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mi>n</mi><mi>q</mi></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>q</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>−</mo><msub><mover><mi>Y</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">MSEP = \frac{1}{nq} \sum_{i=1}^{n} \sum_{j=1}^{q} (Y_{i,j} - \hat{Y}_{i,j})^2</annotation></semantics></math></p>
<p>Then, we select the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mrow><mi>b</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">h_{best}</annotation></semantics></math>
number of components which corresponds to the lower
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
value.</p>
</div>
<div class="section level4">
<h4 id="q2-criterion">Q2 criterion<a class="anchor" aria-label="anchor" href="#q2-criterion"></a>
</h4>
<p>An other way to assess such a model performance consists in using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Q</mi><mn>2</mn></msup><annotation encoding="application/x-tex">Q^2</annotation></semantics></math>
criterion.</p>
<p>What is Q² indicator ?</p>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Q</mi><mn>2</mn></msup><annotation encoding="application/x-tex">Q^2</annotation></semantics></math>
is an assessment indicator for PLS models; for each new component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>,
a new matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">Y^{(h)}</annotation></semantics></math>
is obtained by deflation and compared to the corresponding prediction
matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mover><mi>Y</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\hat{Y}^{(h)}</annotation></semantics></math>.
The Q2 therefore takes this comparison into account. A
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Q</mi><mn>2</mn></msup><annotation encoding="application/x-tex">Q^2</annotation></semantics></math>
value close to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
indicates a good performance. To compute this figure, we must compute
two more indicators : the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>S</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">RSS</annotation></semantics></math>
and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>R</mi><mi>E</mi><mi>S</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">PRESS</annotation></semantics></math>.</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>S</mi><msub><mi>S</mi><mi>h</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>q</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>−</mo><mover><mi>Y</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>q</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">RSS_h = \sum_{i=1}^{n} \sum_{j=1}^{q} (Y^{(h)} - \hat{Y})^2 =  \sum_{i=1}^{n} \sum_{j=1}^{q} (Y^{(h+1)}_{i,j})^2</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>R</mi><mi>E</mi><mi>S</mi><msub><mi>S</mi><mi>h</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><mi>n</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>q</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>−</mo><msub><mover><mi>Y</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><mi>n</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>q</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">PRESS_h = \sum_{i\in test}^{n} \sum_{j=1}^{q} (Y_{i,j}^{(h)} - \hat{Y}_{i,j})^2 =  \sum_{i\in test}^{n} \sum_{j=1}^{q} (Y^{(h+1)}_{i,j})^2</annotation></semantics></math></p>
<p>Then,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Q</mi><mn>2</mn></msup><annotation encoding="application/x-tex">Q^2</annotation></semantics></math>
is defined by this formula :</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Q</mi><mi>h</mi><mn>2</mn></msubsup><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mi>P</mi><mi>R</mi><mi>E</mi><mi>S</mi><msub><mi>S</mi><mi>h</mi></msub></mrow><mrow><mi>R</mi><mi>S</mi><msub><mi>S</mi><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">Q^2_h = 1 - \frac{PRESS_h}{RSS_{h-1}}</annotation></semantics></math></p>
<p>How to use Q² ?</p>
<p>We compare the value of this criterion to a certain limit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>
; this limit is conventionally equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><msup><mn>0.95</mn><mn>2</mn></msup><mo>=</mo><mn>0.0975</mn></mrow><annotation encoding="application/x-tex">1-0.95^2 = 0.0975</annotation></semantics></math>.
As long as we have the inequality
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Q</mi><mi>h</mi><mn>2</mn></msubsup><mo>≥</mo><mi>l</mi></mrow><annotation encoding="application/x-tex">Q^2_h \geq l</annotation></semantics></math>,
we keep on following iteration ; therefore we stop when we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Q</mi><mi>h</mi><mn>2</mn></msubsup><mo>&lt;</mo><mi>l</mi></mrow><annotation encoding="application/x-tex">Q^2_h &lt; l</annotation></semantics></math>.</p>
<p>Using Q² with R</p>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Q</mi><mn>2</mn></msup><annotation encoding="application/x-tex">Q^2</annotation></semantics></math>
function, available below and named as <code><a href="../reference/q2.PLS.html">q2.PLS()</a></code>, takes
three parameters :</p>
<ul>
<li><p>the model (“pls” class object)</p></li>
<li><p>the mode : we must choose between “regression” or
“canonical”</p></li>
<li><p>the number of maximal components</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="first-model">First model<a class="anchor" aria-label="anchor" href="#first-model"></a>
</h2>
<pre><code><span><span class="co">## [1] "First dataset dimensions : 40 x 11"</span></span></code></pre>
<div class="section level4">
<h4 id="msep-criterion-1">MSEP criterion<a class="anchor" aria-label="anchor" href="#msep-criterion-1"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">msep.res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msep.PLS.html">msep.PLS</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="PLS_perf_files/figure-html/unnamed-chunk-2-1.png" alt="MSEP for the first model" width="700"><p class="caption">
MSEP for the first model
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">msep.res1</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="va">msep1</span> <span class="op">&lt;-</span> <span class="va">msep.res1</span><span class="op">$</span><span class="va">MSEP.cv</span></span>
<span><span class="va">msep.best</span> <span class="op">&lt;-</span> <span class="va">msep1</span><span class="op">[</span><span class="va">h.best</span><span class="op">]</span></span></code></pre></div>
<p>The <code>msep.PLS</code> function gives us a optimal number of
components equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
7, therefore we suggest to select 7 components in our first model.</p>
</div>
<div class="section level4">
<h4 id="q2-criterion-1">Q2 criterion<a class="anchor" aria-label="anchor" href="#q2-criterion-1"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">q2.res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/q2.PLS.html">q2.PLS</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span>
<span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">q2.res1</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="fu"><a href="../reference/q2.PLS.html">q2.PLS</a></span><span class="op">(</span><span class="va">model1</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">h.best</span><span class="op">+</span><span class="fl">1</span>, <span class="va">ncomp.max</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">q2</span></span></code></pre></div>
<div class="figure">
<img src="PLS_perf_files/figure-html/unnamed-chunk-3-1.png" alt="Q2 values for the first model" width="700"><p class="caption">
Q2 values for the first model
</p>
</div>
<pre><code><span><span class="co">##      Comp1      Comp2      Comp3 </span></span>
<span><span class="co">##  0.7920627  0.3108891 -1.8832754</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q2.1</span> <span class="op">&lt;-</span> <span class="va">q2.res1</span><span class="op">$</span><span class="va">q2</span></span></code></pre></div>
<p>The <code>q2.pls</code> function gives us a optimal number of
components to select equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
2, therefore we suggest to select 2 components in our first model.</p>
</div>
<div class="section level4">
<h4 id="individuals-plot">Individuals plot<a class="anchor" aria-label="anchor" href="#individuals-plot"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.indiv.html">plot.indiv</a></span><span class="op">(</span><span class="va">model1</span>, compX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">graphX</span></span></code></pre></div>
<p><img src="PLS_perf_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.indiv.html">plot.indiv</a></span><span class="op">(</span><span class="va">model1</span>, compX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">graphX</span></span></code></pre></div>
<p><img src="PLS_perf_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="mixomics-results">MixOmics results<a class="anchor" aria-label="anchor" href="#mixomics-results"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">model.mix1</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="va">perf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf.html">perf</a></span><span class="op">(</span><span class="va">model.mix1</span>, validation <span class="op">=</span> <span class="st">"loo"</span><span class="op">)</span></span>
<span><span class="va">msep.mix1</span> <span class="op">&lt;-</span> <span class="va">perf</span><span class="op">$</span><span class="va">measures</span><span class="op">$</span><span class="va">MSEP</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">value</span></span>
<span><span class="va">msep.mix1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">msep.mix1</span>, nrow <span class="op">=</span> <span class="va">q</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">q2.mix1</span> <span class="op">&lt;-</span> <span class="va">perf</span><span class="op">$</span><span class="va">measures</span><span class="op">$</span><span class="va">Q2.total</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">value</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="second-model">Second model<a class="anchor" aria-label="anchor" href="#second-model"></a>
</h2>
<pre><code><span><span class="co">## [1] "Second dataset dimensions : 40 x 14"</span></span></code></pre>
<div class="section level4">
<h4 id="msep-criterion-2">MSEP criterion<a class="anchor" aria-label="anchor" href="#msep-criterion-2"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">msep.res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msep.PLS.html">msep.PLS</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="PLS_perf_files/figure-html/unnamed-chunk-7-1.png" alt="MSEP for the second model" width="700"><p class="caption">
MSEP for the second model
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">msep.res2</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="va">msep2</span> <span class="op">&lt;-</span> <span class="va">msep.res2</span><span class="op">$</span><span class="va">MSEP.cv</span></span>
<span><span class="va">msep.best</span> <span class="op">&lt;-</span> <span class="va">msep2</span><span class="op">[</span><span class="va">h.best</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># mixOmics results</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">model.mix2</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="va">perf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf.html">perf</a></span><span class="op">(</span><span class="va">model.mix2</span>, validation <span class="op">=</span> <span class="st">"loo"</span><span class="op">)</span></span>
<span><span class="va">msep.mix2</span> <span class="op">&lt;-</span> <span class="va">perf</span><span class="op">$</span><span class="va">measures</span><span class="op">$</span><span class="va">MSEP</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">value</span></span>
<span><span class="va">msep.mix2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">msep.mix2</span>, nrow <span class="op">=</span> <span class="va">q</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code>msep.PLS</code> function gives us a optimal number of
components equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
8.</p>
</div>
<div class="section level4">
<h4 id="q2-criterion-2">Q2 criterion<a class="anchor" aria-label="anchor" href="#q2-criterion-2"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">q2.res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/q2.PLS.html">q2.PLS</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span></span>
<span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">q2.res2</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="fu"><a href="../reference/q2.PLS.html">q2.PLS</a></span><span class="op">(</span><span class="va">model2</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">h.best</span><span class="op">+</span><span class="fl">1</span>, <span class="va">ncomp.max</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">q2</span></span></code></pre></div>
<div class="figure">
<img src="PLS_perf_files/figure-html/unnamed-chunk-8-1.png" alt="Q2 values for the second model" width="700"><p class="caption">
Q2 values for the second model
</p>
</div>
<pre><code><span><span class="co">##        Comp1        Comp2 </span></span>
<span><span class="co">##  0.350568774 -0.002592037</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q2.2</span> <span class="op">&lt;-</span> <span class="va">q2.res2</span><span class="op">$</span><span class="va">q2</span></span></code></pre></div>
<p>The <code>q2.pls</code> function gives us a optimal number of
components to select equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
1.</p>
</div>
<div class="section level4">
<h4 id="individuals-plot-1">Individuals plot<a class="anchor" aria-label="anchor" href="#individuals-plot-1"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.indiv.html">plot.indiv</a></span><span class="op">(</span><span class="va">model2</span>, compX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">graphX</span></span></code></pre></div>
<p><img src="PLS_perf_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.indiv.html">plot.indiv</a></span><span class="op">(</span><span class="va">model2</span>, compX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">graphX</span></span></code></pre></div>
<p><img src="PLS_perf_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="mixomics-results-1">MixOmics results<a class="anchor" aria-label="anchor" href="#mixomics-results-1"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">model.mix2</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="va">perf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf.html">perf</a></span><span class="op">(</span><span class="va">model.mix2</span>, validation <span class="op">=</span> <span class="st">"loo"</span><span class="op">)</span></span>
<span><span class="va">msep.mix2</span> <span class="op">&lt;-</span> <span class="va">perf</span><span class="op">$</span><span class="va">measures</span><span class="op">$</span><span class="va">MSEP</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">value</span></span>
<span><span class="va">msep.mix2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">msep.mix2</span>, nrow <span class="op">=</span> <span class="va">q</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">q2.mix2</span> <span class="op">&lt;-</span> <span class="va">perf</span><span class="op">$</span><span class="va">measures</span><span class="op">$</span><span class="va">Q2.total</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">value</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="third-model">Third model<a class="anchor" aria-label="anchor" href="#third-model"></a>
</h2>
<pre><code><span><span class="co">## [1] "Yarn dataset dimensions : 28 x 269"</span></span></code></pre>
<div class="section level4">
<h4 id="msep-criterion-3">MSEP criterion<a class="anchor" aria-label="anchor" href="#msep-criterion-3"></a>
</h4>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">msep.res3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msep.PLS.html">msep.PLS</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="PLS_perf_files/figure-html/unnamed-chunk-12-1.png" alt="MSEP for the third model" width="700"><p class="caption">
MSEP for the third model
</p>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">msep.res3</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="va">msep3</span> <span class="op">&lt;-</span> <span class="va">msep.res3</span><span class="op">$</span><span class="va">MSEP.cv</span></span>
<span><span class="va">msep.best</span> <span class="op">&lt;-</span> <span class="va">msep3</span><span class="op">[</span><span class="va">h.best</span><span class="op">]</span></span></code></pre></div>
<p>The <code>msep.PLS</code> function gives us a optimal number of
components equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
8.</p>
</div>
<div class="section level4">
<h4 id="q2-criterion-3">Q2 criterion<a class="anchor" aria-label="anchor" href="#q2-criterion-3"></a>
</h4>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">q2.res3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/q2.PLS.html">q2.PLS</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span></span>
<span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">q2.res3</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="fu"><a href="../reference/q2.PLS.html">q2.PLS</a></span><span class="op">(</span><span class="va">model3</span>, ncomp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">h.best</span><span class="op">+</span><span class="fl">1</span>, <span class="va">ncomp.max</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">q2</span></span></code></pre></div>
<div class="figure">
<img src="PLS_perf_files/figure-html/unnamed-chunk-13-1.png" alt="Q2 values for the third model" width="700"><p class="caption">
Q2 values for the third model
</p>
</div>
<pre><code><span><span class="co">##      Comp1      Comp2      Comp3 </span></span>
<span><span class="co">##  0.8954745  0.5508883 -3.7792077</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q2.3</span> <span class="op">&lt;-</span> <span class="va">q2.res3</span><span class="op">$</span><span class="va">q2</span></span></code></pre></div>
<p>The <code>q2.pls</code> function gives us a optimal number of
components to select equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
2.</p>
</div>
<div class="section level4">
<h4 id="individuals-plot-2">Individuals plot<a class="anchor" aria-label="anchor" href="#individuals-plot-2"></a>
</h4>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot.indiv.html">plot.indiv</a></span><span class="op">(</span><span class="va">model3</span>, compX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">graphX</span></span></code></pre></div>
<p><img src="PLS_perf_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot.indiv.html">plot.indiv</a></span><span class="op">(</span><span class="va">model3</span>, compX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">graphX</span></span></code></pre></div>
<p><img src="PLS_perf_files/figure-html/unnamed-chunk-14-2.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="mixomics-results-2">MixOmics results<a class="anchor" aria-label="anchor" href="#mixomics-results-2"></a>
</h4>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">model.mix1</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="va">perf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf.html">perf</a></span><span class="op">(</span><span class="va">model.mix3</span>, validation <span class="op">=</span> <span class="st">"loo"</span><span class="op">)</span></span>
<span><span class="va">msep.mix3</span> <span class="op">&lt;-</span> <span class="va">perf</span><span class="op">$</span><span class="va">measures</span><span class="op">$</span><span class="va">MSEP</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">value</span></span>
<span><span class="va">msep.mix3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">msep.mix3</span>, nrow <span class="op">=</span> <span class="va">q</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">q2.mix3</span> <span class="op">&lt;-</span> <span class="va">perf</span><span class="op">$</span><span class="va">measures</span><span class="op">$</span><span class="va">Q2.total</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">value</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparison-with-mixomics-package-functions">Comparison with MixOmics package functions<a class="anchor" aria-label="anchor" href="#comparison-with-mixomics-package-functions"></a>
</h2>
<div class="section level4">
<h4 id="msep-criterion-4">MSEP criterion<a class="anchor" aria-label="anchor" href="#msep-criterion-4"></a>
</h4>
<p>Now, let’s compare the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
values according to the two packages with a plot.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#par(mfrow = c(2,1))</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"pink"</span>,<span class="st">"darkgreen"</span>,<span class="st">"green"</span>,<span class="st">"darkblue"</span>,<span class="st">"lightblue"</span><span class="op">)</span></span>
<span><span class="va">lty</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Model 1 sgPLS"</span>, <span class="st">"Model 1 mixOmics"</span>,<span class="st">"Model 2 sgPLS"</span>, <span class="st">"Model 2 mixOmics"</span>,<span class="st">"Model 3 sgPLS"</span>, <span class="st">"Model 3 mixOmics"</span><span class="op">)</span></span>
<span><span class="va">data.msep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">msep1</span>,<span class="va">msep.mix1</span>,<span class="va">msep2</span>,<span class="va">msep.mix2</span>,<span class="va">msep3</span>,<span class="va">msep.mix3</span><span class="op">)</span>    </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">data.msep</span>, type <span class="op">=</span> <span class="st">"b"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.8</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="va">col</span>, lty <span class="op">=</span> <span class="va">lty</span>, xlab <span class="op">=</span> <span class="st">"Number of components"</span>, ylab <span class="op">=</span> <span class="st">"MSEP values"</span>, main <span class="op">=</span> <span class="st">"MSEP according to the model and to the package"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5</span>, y <span class="op">=</span> <span class="fl">0.8</span>, col <span class="op">=</span> <span class="va">col</span>, lty <span class="op">=</span> <span class="va">lty</span>, legend <span class="op">=</span> <span class="va">legend</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="PLS_perf_files/figure-html/unnamed-chunk-16-1.png" alt="MSEP values compared with sgPLS and mixOmics" width="700"><p class="caption">
MSEP values compared with sgPLS and mixOmics
</p>
</div>
<p>The nuances of red, green and blue represent respectively the first,
second and third model. The dark colors refer to the results obtained
with sgPLS and the light colors with mixOmics.</p>
<p>It seems that the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
values are higher with <code>mixOmics</code> package.</p>
</div>
<div class="section level4">
<h4 id="q2-criterion-4">Q2 criterion<a class="anchor" aria-label="anchor" href="#q2-criterion-4"></a>
</h4>
<p>Now, let’s compare the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">Q2</annotation></semantics></math>
values according to the two packages with a plot.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"pink"</span>,<span class="st">"darkgreen"</span>,<span class="st">"green"</span>,<span class="st">"darkblue"</span>,<span class="st">"lightblue"</span><span class="op">)</span></span>
<span><span class="va">legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Model 1 sgPLS"</span>, <span class="st">"Model 1 mixOmics"</span>,<span class="st">"Model 2 sgPLS"</span>, <span class="st">"Model 2 mixOmics"</span>,<span class="st">"Model 3 sgPLS"</span>, <span class="st">"Model 3 mixOmics"</span><span class="op">)</span></span>
<span><span class="va">lty</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">data.q2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">q2.1</span>,<span class="va">q2.mix1</span>,<span class="va">q2.2</span>,<span class="va">q2.mix2</span>,<span class="va">q2.3</span>,<span class="va">q2.mix3</span><span class="op">)</span>    </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">data.q2</span>, type <span class="op">=</span> <span class="st">"b"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>,<span class="fl">2</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="va">col</span>, lty <span class="op">=</span> <span class="va">lty</span>, xlab <span class="op">=</span> <span class="st">"Number of components"</span>, ylab <span class="op">=</span> <span class="st">"Q2 values"</span>, main <span class="op">=</span> <span class="st">"Q2 according to the model and to the package"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">30</span>, col <span class="op">=</span> <span class="va">col</span>, lty <span class="op">=</span> <span class="va">lty</span>, legend <span class="op">=</span> <span class="va">legend</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="PLS_perf_files/figure-html/unnamed-chunk-17-1.png" alt="Q2 values compared with sgPLS and mixOmics" width="700"><p class="caption">
Q2 values compared with sgPLS and mixOmics
</p>
</div>
<p>The nuances of red, green and blue represent respectively the first,
second and third model. The dark colors refer to the results obtained
with sgPLS and the light colors with mixOmics.</p>
<p>It seems that the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">q2</annotation></semantics></math>
values are sometimes higher with <code>mixOmics</code> package.</p>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>We can notice that these component choice differs strongly according
to the use of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Q_2</annotation></semantics></math>
(1 or 2 components) or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
(7 or 8 components).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
criterion is appreciated for it’s interpretation simplicity while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Q</mi><mn>2</mn></msup><annotation encoding="application/x-tex">Q^2</annotation></semantics></math>
criterion shows that even the first components may be efficient. Lastly,
the plotting allowed to represent population in different
dimensions.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benoit Liquet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
