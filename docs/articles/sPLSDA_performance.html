<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>sPLS-DA performance • sgPLS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="sPLS-DA performance">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sgPLS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-performance" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Performance</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-performance">
<li><a class="dropdown-item" href="../articles/PLS_performance.html">PLS performance</a></li>
    <li><a class="dropdown-item" href="../articles/PLSDA_performance.html">PLS-DA performance</a></li>
    <li><a class="dropdown-item" href="../articles/sPLS_performance.html">sPLS performance</a></li>
    <li><a class="dropdown-item" href="../articles/sPLSDA_performance.html">sPLS-DA performance</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-theory-for-sgpls-methods" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Theory for sgPLS methods</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-theory-for-sgpls-methods">
<li><a class="dropdown-item" href="../articles/PLS_method.html">PLS method</a></li>
    <li><a class="dropdown-item" href="../articles/PLSDA_method.html">PLS-DA method</a></li>
    <li><a class="dropdown-item" href="../articles/sPLS_method.html">sPLS method</a></li>
    <li><a class="dropdown-item" href="../articles/gPLS_method.html">gPLS method</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Archives</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>sPLS-DA performance</h1>
            
            <h4 data-toc-skip class="date">2025-08-01</h4>
      

      <div class="d-none name"><code>sPLSDA_performance.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This page presents an application of the sPLSDA performance
assessment. The PLS method is a quite particular method : there are
several predictions according to the components number selected in the
model. It is the same with sPLSDA. The goal is almost to choose the best
number of component in order to compute the best possible predictions.
For that, we will use two datasets:</p>
<ul>
<li><p>one is a dataset with only five predictor variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mn>1</mn><mo>,</mo><mi>X</mi><mn>2</mn><mo>,</mo><mi>X</mi><mn>3</mn><mo>,</mo><mi>X</mi><mn>4</mn><mo>,</mo><mi>X</mi><mn>5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X = (X1,X2,X3,X4,X5)</annotation></semantics></math>
and two classes.</p></li>
<li><p>the other is a dataset with forty predictor variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mn>1</mn><mo>,</mo><mi>X</mi><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>X</mi><mn>40</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X = (X1,X2,...,X40)</annotation></semantics></math>
ans three classes. With
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">p &gt; n</annotation></semantics></math>,
this dataset approches realist conditions for PLS training.</p></li>
</ul>
<p>To access to predefined functions from sgPLSdevelop package and
manipulate these datasets, run these lines :</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">sgPLSdevelop</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data.create.html">data.cl.create</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">5</span>, list <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># 2 classes by default</span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data.create.html">data.cl.create</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span>, p <span class="op">=</span> <span class="fl">40</span>, classes <span class="op">=</span> <span class="fl">3</span>, list <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Now, it’s time to train a PLS model for each dataset built.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ncomp.max</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="co">#keepX &lt;- rep(4,ncompmax)</span></span>
<span></span>
<span><span class="co"># First model</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data1</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">data1</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sPLSda.html">sPLSda</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>, ncomp <span class="op">=</span> <span class="va">ncomp.max</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Second model</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data2</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">data2</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sPLSda.html">sPLSda</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>, ncomp <span class="op">=</span> <span class="va">ncomp.max</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="leave-one-out-cv">Leave-one-out CV<a class="anchor" aria-label="anchor" href="#leave-one-out-cv"></a>
</h2>
<div class="section level4">
<h4 id="first-model">First model<a class="anchor" aria-label="anchor" href="#first-model"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perf.res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf.html">perf.sPLSda</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span></code></pre></div>
<p><img src="sPLSDA_performance_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">perf.res1</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="va">keepX.best</span> <span class="op">&lt;-</span> <span class="va">perf.res1</span><span class="op">$</span><span class="va">keepX.best</span></span></code></pre></div>
<p>The <code>perf.sPLSda</code> gives us an optimal components number
equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
1, therefore we suggest to select 1 components in our first model. The
function also indicates us to select 5 variables for each component.</p>
</div>
<div class="section level4">
<h4 id="second-model">Second model<a class="anchor" aria-label="anchor" href="#second-model"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perf.res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf.html">perf.sPLSda</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span></span></code></pre></div>
<p><img src="sPLSDA_performance_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">perf.res2</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="va">keepX.best</span> <span class="op">&lt;-</span> <span class="va">perf.res2</span><span class="op">$</span><span class="va">keepX.best</span></span></code></pre></div>
<p>The <code>perf.sPLSda</code> gives us an optimal components number
equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
1, therefore we suggest to select 1 components in our first model. The
function also indicates us to select 40 variables for each
component.</p>
</div>
</div>
<div class="section level2">
<h2 id="fold-cv">10-fold CV<a class="anchor" aria-label="anchor" href="#fold-cv"></a>
</h2>
<div class="section level4">
<h4 id="first-model-1">First model<a class="anchor" aria-label="anchor" href="#first-model-1"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perf.res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf.html">perf.sPLSda</a></span><span class="op">(</span><span class="va">model1</span>, K <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="sPLSDA_performance_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">perf.res1</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="va">keepX.best</span> <span class="op">&lt;-</span> <span class="va">perf.res1</span><span class="op">$</span><span class="va">keepX.best</span></span></code></pre></div>
<p>The <code>perf.sPLSda</code> gives us an optimal components number
equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
1, therefore we suggest to select 1 components in our first model. The
function also indicates us to select 5 variables for each component.</p>
</div>
<div class="section level4">
<h4 id="second-model-1">Second model<a class="anchor" aria-label="anchor" href="#second-model-1"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perf.res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf.html">perf.sPLSda</a></span><span class="op">(</span><span class="va">model2</span>, K <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="sPLSDA_performance_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">perf.res2</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="va">keepX.best</span> <span class="op">&lt;-</span> <span class="va">perf.res2</span><span class="op">$</span><span class="va">keepX.best</span></span></code></pre></div>
<p>The <code>perf.sPLSda</code> gives us an optimal components number
equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
1, therefore we suggest to select 1 components in our first model. The
function also indicates us to select 40 variables for each
component.</p>
</div>
</div>
<div class="section level2">
<h2 id="fold-cv-1">5-fold CV<a class="anchor" aria-label="anchor" href="#fold-cv-1"></a>
</h2>
<div class="section level4">
<h4 id="first-model-2">First model<a class="anchor" aria-label="anchor" href="#first-model-2"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perf.res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf.html">perf.sPLSda</a></span><span class="op">(</span><span class="va">model1</span>, K <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="sPLSDA_performance_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">perf.res1</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="va">keepX.best</span> <span class="op">&lt;-</span> <span class="va">perf.res1</span><span class="op">$</span><span class="va">keepX.best</span></span></code></pre></div>
<p>The <code>perf.sPLSda</code> gives us an optimal components number
equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
1, therefore we suggest to select 1 components in our first model. The
function also indicates us to select 5 variables for each component.</p>
</div>
<div class="section level4">
<h4 id="second-model-2">Second model<a class="anchor" aria-label="anchor" href="#second-model-2"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perf.res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf.html">perf.sPLSda</a></span><span class="op">(</span><span class="va">model2</span>, K <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="sPLSDA_performance_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">perf.res2</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="va">keepX.best</span> <span class="op">&lt;-</span> <span class="va">perf.res2</span><span class="op">$</span><span class="va">keepX.best</span></span></code></pre></div>
<p>The <code>perf.sPLSda</code> gives us an optimal components number
equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
1, therefore we suggest to select 1 components in our first model. The
function also indicates us to select 40 variables for each
component.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benoit Liquet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
