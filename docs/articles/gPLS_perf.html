<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>gPLS performance • sgPLSdevelop</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="gPLS performance">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sgPLSdevelop</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-performance" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Performance</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-performance">
<li><a class="dropdown-item" href="../articles/PLS_perf.html">PLS performance</a></li>
    <li><a class="dropdown-item" href="../articles/PLSDA_perf.html">PLSDA performance</a></li>
    <li><a class="dropdown-item" href="../articles/sPLS_perf.html">Sparse PLS performance</a></li>
    <li><a class="dropdown-item" href="../articles/gPLS_perf.html">Group PLS performance</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-theory-for-sgpls-methods" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Theory for sgPLS methods</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-theory-for-sgpls-methods">
<li><a class="dropdown-item" href="../articles/PLS_method.html">PLS method</a></li>
    <li><a class="dropdown-item" href="../articles/PLSDA_method.html">PLSDA method</a></li>
    <li><a class="dropdown-item" href="../articles/sPLS_method.html">sPLS method</a></li>
    <li><a class="dropdown-item" href="../articles/gPLS_method.html">gPLS method</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>gPLS performance</h1>
            
            <h4 data-toc-skip class="date">2025-09-03</h4>
      

      <div class="d-none name"><code>gPLS_perf.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This page presents an application of the gPLS performance assessment.
Like the PLS method, there are several predictions according to the
components number selected in the model. The goal is to choose the best
number of component in gPLS regression in order to compute the best
possible predictions but also to select the best number of groups of
variables. For that, we will use two datasets:</p>
<ul>
<li><p>one dataset with 18
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
variables ans 12
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
variables</p></li>
<li><p>one dataset containing real data about NIR spectra.</p></li>
</ul>
<p>To access to predefined functions from sgPLSdevelop package and
manipulate these datasets, run these lines:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://daniel-stage.github.io/sgPLS_develop/" class="external-link">sgPLSdevelop</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/khliland/pls" class="external-link">pls</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data.create.html">data.create</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">18</span>, q <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">yarn</span><span class="op">)</span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">yarn</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "First dataset dimensions : 40 x 30"</span></span></code></pre>
<pre><code><span><span class="co">## [1] "Second dataset dimensions : 28 x 269"</span></span></code></pre>
<p><strong>gPLS performance assessment using MSEP</strong></p>
<p>An good way to assess such a model performance consists by using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
criterion.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
is computed as follow :</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mi>n</mi><mi>q</mi></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>q</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>−</mo><msub><mover><mi>Y</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">MSEP = \frac{1}{nq} \sum_{i=1}^{n} \sum_{j=1}^{q} (Y_{i,j} - \hat{Y}_{i,j})^2</annotation></semantics></math></p>
<p>The following code lines will allow to select the best number of
components and then the best number of groups for each dataset. Some
plots will accompany the results.</p>
<p>However, one might wonder if the best number of components is the
same whatever the number of selected groups. There will be therefore,
for each dataset, a subsection showing a plot of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
for each number of groups and for each number of components
simultaneously.</p>
</div>
<div class="section level2">
<h2 id="first-dataset">First dataset<a class="anchor" aria-label="anchor" href="#first-dataset"></a>
</h2>
<p>Let’s consider that the first dataset contains for example 6 groups
of 3 variables in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ncomp.max</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># First dataset</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data1</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data1</span><span class="op">$</span><span class="va">Y</span></span></code></pre></div>
<div class="section level3">
<h3 id="selection-of-the-best-number-of-components">Selection of the best number of components<a class="anchor" aria-label="anchor" href="#selection-of-the-best-number-of-components"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ind.block.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">15</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">ngroups</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">keepX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">ngroups</span>,<span class="va">ncomp.max</span><span class="op">)</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gPLS.html">gPLS</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">ncomp.max</span>, keepX <span class="op">=</span> <span class="va">keepX</span>, ind.block.x <span class="op">=</span> <span class="va">ind.block.x</span><span class="op">)</span></span>
<span><span class="va">perf.res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf.html">perf.gPLS</a></span><span class="op">(</span><span class="va">model1</span>, progressBar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">msep</span> <span class="op">&lt;-</span> <span class="va">perf.res1</span><span class="op">$</span><span class="va">MSEP</span></span>
<span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">perf.res1</span><span class="op">$</span><span class="va">h.best.msep</span></span>
<span><span class="va">h.best2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">msep</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">msep</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"blue"</span>, main <span class="op">=</span> <span class="st">"MSEP according to the number of components"</span>, xlab <span class="op">=</span> <span class="st">"number of components"</span>, ylab <span class="op">=</span> <span class="st">"MSEP"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gPLS_perf_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>In this case, we therefore choose 5 components.</p>
</div>
<div class="section level3">
<h3 id="selection-of-the-best-number-of-groups">Selection of the best number of groups<a class="anchor" aria-label="anchor" href="#selection-of-the-best-number-of-groups"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid.X</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">ngroups</span> <span class="co"># grid for the number of groups of variables</span></span>
<span><span class="va">tun</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sgPLSdevelop/man/tuning.gPLS.X.html" class="external-link">tuning.gPLS.X</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">h.best</span>,grid.X <span class="op">=</span> <span class="va">grid.X</span>,setseed <span class="op">=</span> <span class="fl">1</span>,ind.block.x <span class="op">=</span> <span class="va">ind.block.x</span><span class="op">)</span></span>
<span><span class="va">keepX.best</span> <span class="op">&lt;-</span> <span class="va">tun</span><span class="op">$</span><span class="va">keepX</span></span>
<span><span class="va">msep.gr</span> <span class="op">&lt;-</span> <span class="va">tun</span><span class="op">$</span><span class="va">MSEP</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">msep.gr</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"orange"</span>, main <span class="op">=</span> <span class="st">"MSEP according to the number of selected groups"</span>, xlab <span class="op">=</span> <span class="st">"number of selected groups"</span>, ylab <span class="op">=</span> <span class="st">"MSEP"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gPLS_perf_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>And we keep 6
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
variable groups.</p>
</div>
<div class="section level3">
<h3 id="checking-of-the-best-number-of-components">Checking of the best number of components<a class="anchor" aria-label="anchor" href="#checking-of-the-best-number-of-components"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid.h</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">ncomp.max</span></span>
<span><span class="va">data.msep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>row.names <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">ngroups</span><span class="op">)</span></span>
<span><span class="va">lty</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">ncomp.max</span><span class="op">)</span></span>
<span><span class="va">min.msep</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">max.msep</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">h</span> <span class="kw">in</span> <span class="va">grid.h</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">tun</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sgPLSdevelop/man/tuning.gPLS.X.html" class="external-link">tuning.gPLS.X</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">h</span>,grid.X <span class="op">=</span> <span class="va">grid.X</span>,setseed <span class="op">=</span> <span class="fl">1</span>,ind.block.x <span class="op">=</span> <span class="va">ind.block.x</span><span class="op">)</span></span>
<span>  <span class="va">msep</span> <span class="op">&lt;-</span> <span class="va">tun</span><span class="op">$</span><span class="va">MSEP</span></span>
<span>  <span class="va">data.msep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">data.msep</span>,<span class="va">msep</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">msep</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">min.msep</span><span class="op">)</span><span class="op">{</span><span class="va">min.msep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">msep</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">msep</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">max.msep</span><span class="op">)</span><span class="op">{</span><span class="va">max.msep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">msep</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data.msep</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"comp"</span>,<span class="fl">1</span><span class="op">:</span><span class="va">ncomp.max</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot display</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">data.msep</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="va">grid.h</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">min.msep</span>,<span class="va">max.msep</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"MSEP"</span>, xlab <span class="op">=</span> <span class="st">"Number of selected groups"</span>, lty <span class="op">=</span> <span class="va">lty</span>, main <span class="op">=</span> <span class="st">"MSEP according to the number of selected groups"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gPLS_perf_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>The previous plot confirms the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
is lower when we increase the number of components. Here the
<code>ncomp.max</code> is set to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>5</mn><annotation encoding="application/x-tex">5</annotation></semantics></math>
but we may also raise this value and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
might be even lower.</p>
</div>
<div class="section level3">
<h3 id="population-dispersion">Population dispersion<a class="anchor" aria-label="anchor" href="#population-dispersion"></a>
</h3>
<p>Now let’s take a look about the population projected on the best
components</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">keepX.best</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">keepX.best</span>,<span class="va">ncomp.max</span><span class="op">)</span> <span class="co"># In gPLS function, keepX must be a vector.</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gPLS.html">gPLS</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">ncomp.max</span>, keepX <span class="op">=</span> <span class="va">keepX.best</span>, ind.block.x <span class="op">=</span> <span class="va">ind.block.x</span><span class="op">)</span></span>
<span><span class="va">pop.model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot.indiv.html">plot.indiv</a></span><span class="op">(</span><span class="va">model1</span>, compX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h.best</span>,<span class="va">h.best2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pop.model1</span><span class="op">$</span><span class="va">graphX</span></span></code></pre></div>
<p><img src="gPLS_perf_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="second-dataset">Second dataset<a class="anchor" aria-label="anchor" href="#second-dataset"></a>
</h2>
<p>Let’s consider now that the second dataset contains for example 27
groups in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
(26 groups of size 10 and 1 group of size 8).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Second dataset</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data2</span><span class="op">$</span><span class="va">NIR</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data2</span><span class="op">$</span><span class="va">density</span></span></code></pre></div>
<div class="section level3">
<h3 id="selection-of-the-best-number-of-components-1">Selection of the best number of components<a class="anchor" aria-label="anchor" href="#selection-of-the-best-number-of-components-1"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ind.block.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">260</span>,<span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">ngroups</span> <span class="op">&lt;-</span> <span class="fl">27</span></span>
<span><span class="va">keepX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">ngroups</span>,<span class="va">ncomp.max</span><span class="op">)</span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gPLS.html">gPLS</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">ncomp.max</span>, keepX <span class="op">=</span> <span class="va">keepX</span>, ind.block.x <span class="op">=</span> <span class="va">ind.block.x</span><span class="op">)</span></span>
<span><span class="va">perf.res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf.html">perf.gPLS</a></span><span class="op">(</span><span class="va">model2</span>, progressBar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">msep</span> <span class="op">&lt;-</span> <span class="va">perf.res2</span><span class="op">$</span><span class="va">MSEP</span></span>
<span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">perf.res2</span><span class="op">$</span><span class="va">h.best.msep</span></span>
<span><span class="va">h.best2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">msep</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">msep</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"blue"</span>, main <span class="op">=</span> <span class="st">"MSEP according to the number of components"</span>, xlab <span class="op">=</span> <span class="st">"number of components"</span>, ylab <span class="op">=</span> <span class="st">"MSEP"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gPLS_perf_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>In this case, we therefore choose 5 components.</p>
</div>
<div class="section level3">
<h3 id="selection-of-the-best-number-of-groups-1">Selection of the best number of groups<a class="anchor" aria-label="anchor" href="#selection-of-the-best-number-of-groups-1"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid.X</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">ngroups</span> <span class="co"># grid for the number of groups of variables</span></span>
<span><span class="va">tun</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sgPLSdevelop/man/tuning.gPLS.X.html" class="external-link">tuning.gPLS.X</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">h.best</span>,grid.X <span class="op">=</span> <span class="va">grid.X</span>,setseed <span class="op">=</span> <span class="fl">1</span>,ind.block.x <span class="op">=</span> <span class="va">ind.block.x</span><span class="op">)</span></span>
<span><span class="va">keepX.best</span> <span class="op">&lt;-</span> <span class="va">tun</span><span class="op">$</span><span class="va">keepX</span></span>
<span><span class="va">msep.gr</span> <span class="op">&lt;-</span> <span class="va">tun</span><span class="op">$</span><span class="va">MSEP</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">msep.gr</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"orange"</span>, main <span class="op">=</span> <span class="st">"MSEP according to the number of selected groups"</span>, xlab <span class="op">=</span> <span class="st">"number of selected groups"</span>, ylab <span class="op">=</span> <span class="st">"MSEP"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gPLS_perf_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>And we keep 4
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
variable groups.</p>
</div>
<div class="section level3">
<h3 id="checking-of-the-best-number-of-components-1">Checking of the best number of components<a class="anchor" aria-label="anchor" href="#checking-of-the-best-number-of-components-1"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid.h</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">ncomp.max</span></span>
<span><span class="va">data.msep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>row.names <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">ngroups</span><span class="op">)</span></span>
<span><span class="va">lty</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">ncomp.max</span><span class="op">)</span></span>
<span><span class="va">min.msep</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">max.msep</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">h</span> <span class="kw">in</span> <span class="va">grid.h</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">tun</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sgPLSdevelop/man/tuning.gPLS.X.html" class="external-link">tuning.gPLS.X</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">h</span>,grid.X <span class="op">=</span> <span class="va">grid.X</span>,setseed <span class="op">=</span> <span class="fl">1</span>,ind.block.x <span class="op">=</span> <span class="va">ind.block.x</span><span class="op">)</span></span>
<span>  <span class="va">msep</span> <span class="op">&lt;-</span> <span class="va">tun</span><span class="op">$</span><span class="va">MSEP</span></span>
<span>  <span class="va">data.msep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">data.msep</span>,<span class="va">msep</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">msep</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">min.msep</span><span class="op">)</span><span class="op">{</span><span class="va">min.msep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">msep</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">msep</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">max.msep</span><span class="op">)</span><span class="op">{</span><span class="va">max.msep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">msep</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data.msep</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"comp"</span>,<span class="fl">1</span><span class="op">:</span><span class="va">ncomp.max</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot display</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">data.msep</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="va">grid.h</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">min.msep</span>,<span class="va">max.msep</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"MSEP"</span>, xlab <span class="op">=</span> <span class="st">"Number of selected groups"</span>, lty <span class="op">=</span> <span class="va">lty</span>, main <span class="op">=</span> <span class="st">"MSEP according to the number of selected groups"</span><span class="op">)</span></span></code></pre></div>
<p><img src="gPLS_perf_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>The previous plot confirms the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
is lower when we increase the number of components. Here the
<code>ncomp.max</code> is set to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>5</mn><annotation encoding="application/x-tex">5</annotation></semantics></math>
but we may also raise this value and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
might be even lower.</p>
</div>
<div class="section level3">
<h3 id="population-dispersion-1">Population dispersion<a class="anchor" aria-label="anchor" href="#population-dispersion-1"></a>
</h3>
<p>Now let’s take a look about the population projected on the best
components</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">keepX.best</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">keepX.best</span>,<span class="va">ncomp.max</span><span class="op">)</span> <span class="co"># In gPLS function, keepX must be a vector.</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gPLS.html">gPLS</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">ncomp.max</span>, keepX <span class="op">=</span> <span class="va">keepX.best</span>, ind.block.x <span class="op">=</span> <span class="va">ind.block.x</span><span class="op">)</span></span>
<span><span class="va">pop.model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot.indiv.html">plot.indiv</a></span><span class="op">(</span><span class="va">model1</span>, compX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h.best</span>,<span class="va">h.best2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pop.model1</span><span class="op">$</span><span class="va">graphX</span></span></code></pre></div>
<p><img src="gPLS_perf_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benoit Liquet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
