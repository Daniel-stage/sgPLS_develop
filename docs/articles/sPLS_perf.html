<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>sPLS performance • sgPLSdevelop</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="sPLS performance">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sgPLSdevelop</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-performance" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Performance</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-performance">
<li><a class="dropdown-item" href="../articles/PLS_perf.html">PLS performance</a></li>
    <li><a class="dropdown-item" href="../articles/PLSDA_perf.html">PLSDA performance</a></li>
    <li><a class="dropdown-item" href="../articles/sPLS_perf.html">Sparse PLS performance</a></li>
    <li><a class="dropdown-item" href="../articles/gPLS_perf.html">Group PLS performance</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-theory-for-sgpls-methods" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Theory for sgPLS methods</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-theory-for-sgpls-methods">
<li><a class="dropdown-item" href="../articles/PLS_method.html">PLS method</a></li>
    <li><a class="dropdown-item" href="../articles/PLSDA_method.html">PLSDA method</a></li>
    <li><a class="dropdown-item" href="../articles/sPLS_method.html">sPLS method</a></li>
    <li><a class="dropdown-item" href="../articles/gPLS_method.html">gPLS method</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>sPLS performance</h1>
            
            <h4 data-toc-skip class="date">2025-07-30</h4>
      

      <div class="d-none name"><code>sPLS_perf.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This page presents an application of the sPLS performance assessment.
The sPLS method is a quite particular method : there are several
predictions according to the components number selected in the model.
The goal is almost to choose the best number of component in sPLS
regression in order to compute the best possible predictions but also to
select the best number of variables. For that, we will use three
datasets:</p>
<ul>
<li><p>one is a dataset with only one response variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.</p></li>
<li><p>the other is a dataset with four response variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mn>1</mn><mo>,</mo><mi>Y</mi><mn>2</mn><mo>,</mo><mi>Y</mi><mn>3</mn><mo>,</mo><mi>Y</mi><mn>4</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y = (Y1,Y2,Y3,Y4)</annotation></semantics></math>.</p></li>
<li><p>the last dataset contains real data about NIR spectra.</p></li>
</ul>
<p>To access to predefined functions from sgPLSdevelop package and
manipulate these datasets, run these lines :</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://daniel-stage.github.io/sgPLS_develop/" class="external-link">sgPLSdevelop</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/khliland/pls" class="external-link">pls</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data.create.html">data.create</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">10</span>, list <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data.create.html">data.create</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">10</span>, q <span class="op">=</span> <span class="fl">4</span>, list <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">yarn</span><span class="op">)</span></span>
<span><span class="va">data3</span> <span class="op">&lt;-</span> <span class="va">yarn</span></span>
<span></span>
<span><span class="va">ncomp.max</span> <span class="op">&lt;-</span> <span class="fl">8</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "First dataset dimensions : 40 x 11"</span></span></code></pre>
<pre><code><span><span class="co">## [1] "Second dataset dimensions : 40 x 14"</span></span></code></pre>
<pre><code><span><span class="co">## [1] "Yarn dataset dimensions : 28 x 269"</span></span></code></pre>
<p>For the two first datasets, the population is set to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>40</mn></mrow><annotation encoding="application/x-tex">n = 40</annotation></semantics></math>
by default, which is close to actual conditions. Let’s also notice that,
on average, the response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
is a linear combination from the predictors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>.
Indeed, the function includes a matrix product
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>X</mi><mi>B</mi><mo>+</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">Y = XB + E</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
the weight matrix and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>E</mi><annotation encoding="application/x-tex">E</annotation></semantics></math>
matrix the gaussian noise. This linearity condition is important in
order to have a good performance of the model, the PLS method using
linearity combinaison.</p>
<p>Now, it’s time to train a PLS model for each dataset built or
imported.</p>
</div>
<div class="section level2">
<h2 id="spls-performance-assessment-using-msep">sPLS performance assessment using MSEP<a class="anchor" aria-label="anchor" href="#spls-performance-assessment-using-msep"></a>
</h2>
<p>An good way to assess such a model performance consists by using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
criterion.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">MSEP</annotation></semantics></math>
is computed as follow :</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mi>n</mi><mi>q</mi></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>q</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>−</mo><msub><mover><mi>Y</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">MSEP = \frac{1}{nq} \sum_{i=1}^{n} \sum_{j=1}^{q} (Y_{i,j} - \hat{Y}_{i,j})^2</annotation></semantics></math></p>
<p>The function named <code>tuning.sPLS.XY</code> will allow to assess
the performance and to choose the best parameters. This function outputs
the best tuning parameters but also two MSEP plots : the one shows the
MSEP according to the number of components and the other shows the MSEP
according to the number of selected variables in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.
Particularly, in multivariate sPLS
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">q&gt;1</annotation></semantics></math>),
the “plot” is a table of MSEP values.</p>
<p>Once the best tuning parameters obtained, it is interesting to
display the population projected on the best components : a scatterplot
will be used. The component used for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
axe will be the <code>h.best</code> given by
<code>tuning.sPLS.XY</code>. The component used for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
axe will be the second best component named <code>h.best2</code>
respecting the condition <code>h.best2</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>&lt;</mo><annotation encoding="application/x-tex">&lt;</annotation></semantics></math><code>h.best</code> to make sure the <code>plot.indiv</code> function
work (the sPLS model is built with <code>h.best</code>components.</p>
</div>
<div class="section level2">
<h2 id="first-model-msep">First model MSEP<a class="anchor" aria-label="anchor" href="#first-model-msep"></a>
</h2>
<div class="section level3">
<h3 id="msep-for-tuning-parameters">MSEP for tuning parameters<a class="anchor" aria-label="anchor" href="#msep-for-tuning-parameters"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First model</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data1</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data1</span><span class="op">$</span><span class="va">Y</span></span>
<span></span>
<span><span class="co"># tuning</span></span>
<span><span class="va">perf.res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tuning.sPLS.XY.html">tuning.sPLS.XY</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">ncomp.max</span><span class="op">)</span></span></code></pre></div>
<p><img src="sPLS_perf_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">msep.h</span> <span class="op">&lt;-</span> <span class="va">perf.res1</span><span class="op">$</span><span class="va">MSEP.h</span></span>
<span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">perf.res1</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="va">h.best2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">msep.h</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">h.best</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># h.best2 &lt; h.best</span></span>
<span><span class="va">keepX.best</span> <span class="op">&lt;-</span> <span class="va">perf.res1</span><span class="op">$</span><span class="va">keepX.best</span></span>
<span><span class="va">keepY.best</span> <span class="op">&lt;-</span> <span class="va">perf.res1</span><span class="op">$</span><span class="va">keepY.best</span></span></code></pre></div>
<p>The <code>perf.sPLS</code> gives us a optimal components number equal
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
8, therefore we suggest to select 8 components in our first model. It
indicates us also to select 3 variables for each component.</p>
</div>
<div class="section level3">
<h3 id="population-dispersion">Population dispersion<a class="anchor" aria-label="anchor" href="#population-dispersion"></a>
</h3>
<p>Let’s take a look at the population projected on the best
components.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sPLS.html">sPLS</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">h.best</span>, keepX <span class="op">=</span> <span class="va">keepX.best</span><span class="op">)</span></span>
<span><span class="va">pop.model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot.indiv.html">plot.indiv</a></span><span class="op">(</span><span class="va">model1</span>, compX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h.best</span>, <span class="va">h.best2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pop.model1</span><span class="op">$</span><span class="va">graphX</span></span></code></pre></div>
<p><img src="sPLS_perf_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="second-model-msep">Second model MSEP<a class="anchor" aria-label="anchor" href="#second-model-msep"></a>
</h2>
<div class="section level3">
<h3 id="msep-for-tuning-parameters-1">MSEP for tuning parameters<a class="anchor" aria-label="anchor" href="#msep-for-tuning-parameters-1"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># second model</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data2</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data2</span><span class="op">$</span><span class="va">Y</span></span>
<span></span>
<span><span class="co">#tuning</span></span>
<span><span class="va">perf.res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tuning.sPLS.XY.html">tuning.sPLS.XY</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">ncomp.max</span><span class="op">)</span></span></code></pre></div>
<p><img src="sPLS_perf_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">msep.h</span> <span class="op">&lt;-</span> <span class="va">perf.res2</span><span class="op">$</span><span class="va">MSEP.h</span></span>
<span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">perf.res2</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="va">h.best2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">msep.h</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">h.best</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># h.best2 &lt; h.best</span></span>
<span><span class="va">keepX.best</span> <span class="op">&lt;-</span> <span class="va">perf.res2</span><span class="op">$</span><span class="va">keepX.best</span></span>
<span><span class="va">keepY.best</span> <span class="op">&lt;-</span> <span class="va">perf.res2</span><span class="op">$</span><span class="va">keepY.best</span></span></code></pre></div>
<p>The <code>perf.sPLS</code> gives us a optimal components number equal
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
8, therefore we suggest to select 8 components in our first model. It
indicates us also to select 9 variables in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
and 3 variables in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="population-dispersion-1">Population dispersion<a class="anchor" aria-label="anchor" href="#population-dispersion-1"></a>
</h3>
<p>Let’s take a look at the population projected on the best
components.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sPLS.html">sPLS</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">h.best</span>, keepX <span class="op">=</span> <span class="va">keepX.best</span>, keepY <span class="op">=</span> <span class="va">keepY.best</span><span class="op">)</span></span>
<span><span class="va">pop.model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot.indiv.html">plot.indiv</a></span><span class="op">(</span><span class="va">model2</span>, compX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h.best</span>, <span class="va">h.best2</span><span class="op">)</span>, compY <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h.best</span>, <span class="va">h.best2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pop.model2</span><span class="op">$</span><span class="va">graphX</span></span></code></pre></div>
<p><img src="sPLS_perf_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pop.model2</span><span class="op">$</span><span class="va">graphY</span></span></code></pre></div>
<p><img src="sPLS_perf_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="third-model-msep">Third model MSEP<a class="anchor" aria-label="anchor" href="#third-model-msep"></a>
</h2>
<div class="section level3">
<h3 id="msep-for-tuning-parameters-2">MSEP for tuning parameters<a class="anchor" aria-label="anchor" href="#msep-for-tuning-parameters-2"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Third model</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data3</span><span class="op">$</span><span class="va">NIR</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data3</span><span class="op">$</span><span class="va">density</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tuning</span></span>
<span><span class="va">perf.res3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tuning.sPLS.XY.html">tuning.sPLS.XY</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">ncomp.max</span><span class="op">)</span></span></code></pre></div>
<p><img src="sPLS_perf_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h.best</span> <span class="op">&lt;-</span> <span class="va">perf.res3</span><span class="op">$</span><span class="va">h.best</span></span>
<span><span class="va">h.best2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">msep.h</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">h.best</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># h.best2 &lt; h.best</span></span>
<span><span class="va">keepX.best</span> <span class="op">&lt;-</span> <span class="va">perf.res3</span><span class="op">$</span><span class="va">keepX.best</span></span>
<span><span class="va">keepY.best</span> <span class="op">&lt;-</span> <span class="va">perf.res3</span><span class="op">$</span><span class="va">keepY.best</span></span></code></pre></div>
<p>The <code>perf.sPLS</code> gives us a optimal components number equal
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">H =</annotation></semantics></math>
8, therefore we suggest to select 8 components in our first model. It
indicates us also to select 268 variables in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
and 1 variables in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="population-dispersion-2">Population dispersion<a class="anchor" aria-label="anchor" href="#population-dispersion-2"></a>
</h3>
<p>Let’s take a look at the population projected on the best
components.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sPLS.html">sPLS</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,ncomp <span class="op">=</span> <span class="va">h.best</span>, keepX <span class="op">=</span> <span class="va">keepX.best</span><span class="op">)</span></span>
<span><span class="va">pop.model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot.indiv.html">plot.indiv</a></span><span class="op">(</span><span class="va">model3</span>, compX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h.best</span>, <span class="va">h.best2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pop.model3</span><span class="op">$</span><span class="va">graphX</span></span></code></pre></div>
<p><img src="sPLS_perf_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benoit Liquet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
